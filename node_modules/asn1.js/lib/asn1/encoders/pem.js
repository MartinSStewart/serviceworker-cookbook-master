'use strict';

const inherits = require('inherits');

const DEREncoder = require('./der');

function PEMEncoder(entity) {
  DEREncoder.call(this, entity);
}
inherits(PEMEncoder, DEREncoder);
module.exports = PEMEncoder;

PEMEncoder.prototype.encode = function encode(data) {
  console.log("PEM");
  console.log(data);
  const buf = DEREncoder.prototype.encode.call(this, data);
  console.log(buf);
  const p = buf.toString('base64');
  const out = [ '-----BEGIN EC PRIVATE KEY-----' ];
  for (let i = 0; i < p.length; i += 64)
    out.push(p.slice(i, i + 64));
  out.push('-----END EC PRIVATE KEY-----');
  return out.join('\n');
};
